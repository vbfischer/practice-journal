{"ast":null,"code":"'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _extends = Object.assign || function (target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i];\n\n    for (var key in source) {\n      if (Object.prototype.hasOwnProperty.call(source, key)) {\n        target[key] = source[key];\n      }\n    }\n  }\n\n  return target;\n};\n\nvar _reactRedux = require('react-redux');\n\nvar _invariant = require('invariant');\n\nvar _invariant2 = _interopRequireDefault(_invariant);\n\nvar _authWrapper = require('../authWrapper');\n\nvar _authWrapper2 = _interopRequireDefault(_authWrapper);\n\nvar _redirect = require('../redirect');\n\nvar _redirect2 = _interopRequireDefault(_redirect);\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nvar connectedDefaults = {\n  authenticatingSelector: function authenticatingSelector() {\n    return false;\n  },\n  allowRedirectBack: true,\n  FailureComponent: _redirect2.default,\n  redirectQueryParamName: 'redirect'\n};\n\nexports.default = function (_ref) {\n  var locationHelperBuilder = _ref.locationHelperBuilder,\n      getRouterRedirect = _ref.getRouterRedirect;\n\n  var connectedRouterRedirect = function connectedRouterRedirect(args) {\n    var allArgs = _extends({}, connectedDefaults, args);\n\n    var FailureComponent = allArgs.FailureComponent,\n        redirectPath = allArgs.redirectPath,\n        authenticatedSelector = allArgs.authenticatedSelector,\n        authenticatingSelector = allArgs.authenticatingSelector,\n        allowRedirectBack = allArgs.allowRedirectBack,\n        redirectQueryParamName = allArgs.redirectQueryParamName;\n\n    var _locationHelperBuilde = locationHelperBuilder({\n      redirectQueryParamName: redirectQueryParamName\n    }),\n        createRedirectLoc = _locationHelperBuilde.createRedirectLoc;\n\n    var redirectPathSelector = void 0;\n\n    if (typeof redirectPath === 'string') {\n      redirectPathSelector = function redirectPathSelector() {\n        return redirectPath;\n      };\n    } else if (typeof redirectPath === 'function') {\n      redirectPathSelector = redirectPath;\n    } else {\n      (0, _invariant2.default)(false, 'redirectPath must be either a string or a function');\n    }\n\n    var allowRedirectBackFn = void 0;\n\n    if (typeof allowRedirectBack === 'boolean') {\n      allowRedirectBackFn = function allowRedirectBackFn() {\n        return allowRedirectBack;\n      };\n    } else if (typeof allowRedirectBack === 'function') {\n      allowRedirectBackFn = allowRedirectBack;\n    } else {\n      (0, _invariant2.default)(false, 'allowRedirectBack must be either a boolean or a function');\n    }\n\n    var redirect = function redirect(replace) {\n      return function (props, path) {\n        return replace(createRedirectLoc(allowRedirectBackFn(props, path))(props, path));\n      };\n    };\n\n    var ConnectedFailureComponent = (0, _reactRedux.connect)(function (state, ownProps) {\n      return {\n        redirect: redirect(getRouterRedirect(ownProps))\n      };\n    })(FailureComponent);\n    return function (DecoratedComponent) {\n      return (0, _reactRedux.connect)(function (state, ownProps) {\n        return {\n          redirectPath: redirectPathSelector(state, ownProps),\n          isAuthenticated: authenticatedSelector(state, ownProps),\n          isAuthenticating: authenticatingSelector(state, ownProps)\n        };\n      })((0, _authWrapper2.default)(_extends({}, allArgs, {\n        FailureComponent: ConnectedFailureComponent\n      }))(DecoratedComponent));\n    };\n  };\n\n  var connectedReduxRedirect = function connectedReduxRedirect(args) {\n    var allArgs = _extends({}, connectedDefaults, args);\n\n    var FailureComponent = allArgs.FailureComponent,\n        redirectPath = allArgs.redirectPath,\n        authenticatedSelector = allArgs.authenticatedSelector,\n        authenticatingSelector = allArgs.authenticatingSelector,\n        allowRedirectBack = allArgs.allowRedirectBack,\n        redirectAction = allArgs.redirectAction,\n        redirectQueryParamName = allArgs.redirectQueryParamName;\n\n    var _locationHelperBuilde2 = locationHelperBuilder({\n      redirectQueryParamName: redirectQueryParamName\n    }),\n        createRedirectLoc = _locationHelperBuilde2.createRedirectLoc;\n\n    var redirectPathSelector = void 0;\n\n    if (typeof redirectPath === 'string') {\n      redirectPathSelector = function redirectPathSelector() {\n        return redirectPath;\n      };\n    } else if (typeof redirectPath === 'function') {\n      redirectPathSelector = redirectPath;\n    } else {\n      (0, _invariant2.default)(false, 'redirectPath must be either a string or a function');\n    }\n\n    var allowRedirectBackFn = void 0;\n\n    if (typeof allowRedirectBack === 'boolean') {\n      allowRedirectBackFn = function allowRedirectBackFn() {\n        return allowRedirectBack;\n      };\n    } else if (typeof allowRedirectBack === 'function') {\n      allowRedirectBackFn = allowRedirectBack;\n    } else {\n      (0, _invariant2.default)(false, 'allowRedirectBack must be either a boolean or a function');\n    }\n\n    var createRedirect = function createRedirect(dispatch) {\n      return {\n        redirect: function redirect(props, path) {\n          return dispatch(redirectAction(createRedirectLoc(allowRedirectBackFn(props, path))(props, path)));\n        }\n      };\n    };\n\n    var ConnectedFailureComponent = (0, _reactRedux.connect)(null, createRedirect)(FailureComponent);\n    return function (DecoratedComponent) {\n      return (0, _reactRedux.connect)(function (state, ownProps) {\n        return {\n          redirectPath: redirectPathSelector(state, ownProps),\n          isAuthenticated: authenticatedSelector(state, ownProps),\n          isAuthenticating: authenticatingSelector(state, ownProps)\n        };\n      })((0, _authWrapper2.default)(_extends({}, allArgs, {\n        FailureComponent: ConnectedFailureComponent\n      }))(DecoratedComponent));\n    };\n  };\n\n  return {\n    connectedRouterRedirect: connectedRouterRedirect,\n    connectedReduxRedirect: connectedReduxRedirect\n  };\n};","map":null,"metadata":{},"sourceType":"script"}