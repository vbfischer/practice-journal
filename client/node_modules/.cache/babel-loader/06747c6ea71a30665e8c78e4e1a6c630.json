{"ast":null,"code":"import _regeneratorRuntime from \"/Users/fischer/Code/practice-journal/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/fischer/Code/practice-journal/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _defineProperty from \"/Users/fischer/Code/practice-journal/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport { RSAA } from 'redux-api-middleware';\nimport { LOAD_USER, LOAD_USER_FAILURE, LOAD_USER_SUCCESS, LOGIN_USER, LOGIN_USER_FAILURE, LOGIN_USER_SUCCESS, LOGOUT, getUser } from './reducer';\nexport var loadUser = function loadUser(id) {\n  return function (dispatch, getState, api) {\n    return dispatch(_defineProperty({}, RSAA, {\n      endpoint: \"/api/v1/users/\".concat(id),\n      method: 'GET',\n      types: [LOAD_USER, LOAD_USER_SUCCESS, LOAD_USER_FAILURE]\n    }));\n  };\n};\nexport var logout = function logout() {\n  return {\n    type: LOGOUT\n  };\n};\nexport var login = function login(username, password) {\n  return function (dispatch, getState, api) {\n    return dispatch(_defineProperty({}, RSAA, {\n      method: 'POST',\n      endpoint: '/api/v1/login',\n      body: JSON.stringify({\n        username: username,\n        password: password\n      }),\n      headers: {\n        Accept: 'application/json',\n        'Content-Type': 'application/json'\n      },\n      types: [LOGIN_USER, LOGIN_USER_SUCCESS, LOGIN_USER_FAILURE]\n    }));\n  };\n};\nexport var loginAndLoadUser = function loginAndLoadUser(username, password) {\n  return (\n    /*#__PURE__*/\n    function () {\n      var _ref = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee(dispatch, getState, api) {\n        var user;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                console.log('loginAndLoadUser', username, password);\n                _context.next = 3;\n                return dispatch(login(username, password));\n\n              case 3:\n                user = getUser(getState());\n                console.log('post dispatch', user.id);\n                return _context.abrupt(\"return\", dispatch(loadUser(user.id)));\n\n              case 6:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      return function (_x, _x2, _x3) {\n        return _ref.apply(this, arguments);\n      };\n    }()\n  );\n};","map":{"version":3,"sources":["/Users/fischer/Code/practice-journal/client/src/redux/actions.js"],"names":["RSAA","LOAD_USER","LOAD_USER_FAILURE","LOAD_USER_SUCCESS","LOGIN_USER","LOGIN_USER_FAILURE","LOGIN_USER_SUCCESS","LOGOUT","getUser","loadUser","id","dispatch","getState","api","endpoint","method","types","logout","type","login","username","password","body","JSON","stringify","headers","Accept","loginAndLoadUser","console","log","user"],"mappings":";;;AAAA,SAASA,IAAT,QAAqB,sBAArB;AACA,SACEC,SADF,EAEEC,iBAFF,EAGEC,iBAHF,EAIEC,UAJF,EAKEC,kBALF,EAMEC,kBANF,EAOEC,MAPF,EAQEC,OARF,QASO,WATP;AAWA,OAAO,IAAMC,QAAQ,GAAG,SAAXA,QAAW,CAAAC,EAAE;AAAA,SAAI,UAACC,QAAD,EAAWC,QAAX,EAAqBC,GAArB;AAAA,WAC5BF,QAAQ,qBACLX,IADK,EACE;AACNc,MAAAA,QAAQ,0BAAmBJ,EAAnB,CADF;AAENK,MAAAA,MAAM,EAAE,KAFF;AAGNC,MAAAA,KAAK,EAAE,CAACf,SAAD,EAAYE,iBAAZ,EAA+BD,iBAA/B;AAHD,KADF,EADoB;AAAA,GAAJ;AAAA,CAAnB;AASP,OAAO,IAAMe,MAAM,GAAG,SAATA,MAAS;AAAA,SAAO;AAAEC,IAAAA,IAAI,EAAEX;AAAR,GAAP;AAAA,CAAf;AAEP,OAAO,IAAMY,KAAK,GAAG,SAARA,KAAQ,CAACC,QAAD,EAAWC,QAAX;AAAA,SAAwB,UAACV,QAAD,EAAWC,QAAX,EAAqBC,GAArB;AAAA,WAC3CF,QAAQ,qBACLX,IADK,EACE;AACNe,MAAAA,MAAM,EAAE,MADF;AAEND,MAAAA,QAAQ,EAAE,eAFJ;AAGNQ,MAAAA,IAAI,EAAEC,IAAI,CAACC,SAAL,CAAe;AAAEJ,QAAAA,QAAQ,EAARA,QAAF;AAAYC,QAAAA,QAAQ,EAARA;AAAZ,OAAf,CAHA;AAINI,MAAAA,OAAO,EAAE;AACPC,QAAAA,MAAM,EAAE,kBADD;AAEP,wBAAgB;AAFT,OAJH;AAQNV,MAAAA,KAAK,EAAE,CAACZ,UAAD,EAAaE,kBAAb,EAAiCD,kBAAjC;AARD,KADF,EADmC;AAAA,GAAxB;AAAA,CAAd;AAcP,OAAO,IAAMsB,gBAAgB,GAAG,SAAnBA,gBAAmB,CAACP,QAAD,EAAWC,QAAX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,+BAAwB,iBAAOV,QAAP,EAAiBC,QAAjB,EAA2BC,GAA3B;AAAA;AAAA;AAAA;AAAA;AAAA;AACtDe,gBAAAA,OAAO,CAACC,GAAR,CAAY,kBAAZ,EAAgCT,QAAhC,EAA0CC,QAA1C;AADsD;AAAA,uBAEhDV,QAAQ,CAACQ,KAAK,CAACC,QAAD,EAAWC,QAAX,CAAN,CAFwC;;AAAA;AAGhDS,gBAAAA,IAHgD,GAGzCtB,OAAO,CAACI,QAAQ,EAAT,CAHkC;AAItDgB,gBAAAA,OAAO,CAACC,GAAR,CAAY,eAAZ,EAA6BC,IAAI,CAACpB,EAAlC;AAJsD,iDAK/CC,QAAQ,CAACF,QAAQ,CAACqB,IAAI,CAACpB,EAAN,CAAT,CALuC;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAAxB;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,CAAzB","sourcesContent":["import { RSAA } from 'redux-api-middleware';\nimport {\n  LOAD_USER,\n  LOAD_USER_FAILURE,\n  LOAD_USER_SUCCESS,\n  LOGIN_USER,\n  LOGIN_USER_FAILURE,\n  LOGIN_USER_SUCCESS,\n  LOGOUT,\n  getUser\n} from './reducer';\n\nexport const loadUser = id => (dispatch, getState, api) =>\n  dispatch({\n    [RSAA]: {\n      endpoint: `/api/v1/users/${id}`,\n      method: 'GET',\n      types: [LOAD_USER, LOAD_USER_SUCCESS, LOAD_USER_FAILURE]\n    }\n  });\n\nexport const logout = () => ({ type: LOGOUT });\n\nexport const login = (username, password) => (dispatch, getState, api) =>\n  dispatch({\n    [RSAA]: {\n      method: 'POST',\n      endpoint: '/api/v1/login',\n      body: JSON.stringify({ username, password }),\n      headers: {\n        Accept: 'application/json',\n        'Content-Type': 'application/json'\n      },\n      types: [LOGIN_USER, LOGIN_USER_SUCCESS, LOGIN_USER_FAILURE]\n    }\n  });\n\nexport const loginAndLoadUser = (username, password) => async (dispatch, getState, api) => {\n  console.log('loginAndLoadUser', username, password);\n  await dispatch(login(username, password));\n  const user = getUser(getState());\n  console.log('post dispatch', user.id);\n  return dispatch(loadUser(user.id));\n};\n"]},"metadata":{},"sourceType":"module"}